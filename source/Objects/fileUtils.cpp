#include "alif.h"
#include "alifCore_fileUtils.h"
#include "alifCore_runtime.h"
//#include "osdefs.h"
#include <locale.h>
//#include <stdlib.h>

#ifdef MS_WINDOWS
#  include <malloc.h>
#  include <windows.h>
#  include <winioctl.h>
//#  include "alifCore_fileUtilsWindows.h
#  if defined(MS_WINDOWS_GAMES) && !defined(MS_WINDOWS_DESKTOP)
#    define PATHCCH_ALLOW_LONG_PATHS 0x01
#  else
#    include <pathcch.h>            // PathCchCombineEx
#  endif
//extern int winerror_to_errno(int);
#endif

#ifdef HAVE_LANGINFO_H
#include <langinfo.h>
#endif

#ifdef HAVE_SYS_IOCTL_H
#include <sys/ioctl.h>
#endif

#ifdef HAVE_NON_UNICODE_WCHAR_T_REPRESENTATION
#include <iconv.h>
#endif

#ifdef HAVE_FCNTL_H
#include <fcntl.h>
#endif
















































































































































































































































































































































































































































































































































































































































wchar_t* alif_decodeLocale(const char* _arg, size_t* _wLen)
{
	wchar_t* wstr{};
	int res = alif_decodeLocaleEx(_arg, &wstr, _wLen, nullptr, 0, Alif_Error_SurroGateEscape);
	if (res != 0) {
		//assert(res != -3);
		if (_wLen != nullptr) {
			*_wLen = (size_t)res;
		}
		return nullptr;
	}
	return wstr;
}
